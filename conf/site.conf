<VirtualHost *:80>
        ServerName localhost
        ServerAlias localhost
        ServerAdmin admin@localhost
    DocumentRoot /home/kuss/local/opt/regal/drupal
    <Directory "/">
    	 Options FollowSymLinks
         AllowOverride None
    </Directory>
    <Directory "/home/kuss/local/opt/regal/drupal">
               Options Indexes FollowSymLinks
               AllowOverride All
               Order allow,deny
               Allow from all
    </Directory>
</VirtualHost>

<VirtualHost *:80>
    ServerName api.localhost
    ServerAlias api.localhost
    ServerAdmin admin@localhost
  
    <Location "/">
               Options Indexes FollowSymLinks
               Order allow,deny
               Allow from all
    </Location>

    ProxyPreserveHost On

    RewriteEngine on

    RewriteRule ^/fedora(.*) http://localhost:8080/fedora$1 [P]
    RewriteRule ^/dnb-urn(.*)  http://localhost:8080/dnb-urn$1 [P]
    RewriteRule ^/oai-pmh(.*)  http://localhost:8080/oai-pmh$1 [P]

    <Proxy http://localhost:9001/>
       <LimitExcept GET HEAD>
                    Require all granted
       </LimitExcept>
    </Proxy>
    ProxyPass /tools/thumby http://localhost:9001/tools/thumby
    ProxyPassReverse /tools/thumby http://localhost:9001/tools/thumby

    <Proxy http://localhost:9002/>
       <LimitExcept GET HEAD>
         Require all granted
       </LimitExcept>
    </Proxy>

    ProxyPass /tools/etikett http://localhost:9002/tools/etikett
    ProxyPassReverse /tools/etikett http://localhost:9002/tools/etikett

    <Proxy http://localhost:9003>
       <Limit POST PUT DELETE>
           Require all granted
      </Limit>
    </Proxy>
    ProxyPass /tools/zettel http://localhost:9003/tools/zettel
    ProxyPassReverse /tools/zettel http://localhost:9003/tools/zettel
   
    <Proxy http://localhost:9200>
       <Limit POST PUT DELETE>
           order deny,allow
           deny from all
           allow from all
      </Limit>
    </Proxy>
    ProxyPass /search http://localhost:9200
    ProxyPassReverse /search /search http://localhost:$ELASTICSEARCH

    <Proxy http://localhost:8080>
          Order deny,allow
          Deny from All
          allow from all
    </Proxy>
    ProxyPass /fedora http://localhost:8080/fedora Keepalive=On
    ProxyPassReverse /fedora http://localhost:8080/fedora

     <Proxy http://localhost:9000/>
       <Limit POST PUT DELETE>
           order deny,allow
           deny from all
           allow from all
      </Limit>
    </Proxy>
    ProxyPass /static !
    ProxyPass / http://localhost:9000/  Keepalive=On
    ProxyPassReverse / / http://localhost:9000/
    
</VirtualHost>

